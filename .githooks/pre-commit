#!/bin/sh
# UBML Pre-commit Hook
#
# This hook ensures:
# 1. Version consistency across all files
# 2. No TypeScript lint errors
# 3. Type checking passes
#
# To install: git config core.hooksPath .githooks

echo "ğŸ” Running pre-commit checks..."

# Check version consistency
echo "\nğŸ“‹ Verifying version consistency..."
npm run verify-versions
if [ $? -ne 0 ]; then
  echo "\nâŒ Version verification failed!"
  echo "Run: npm run update-schema-versions && npm run generate"
  exit 1
fi

# Run linter
echo "\nğŸ”§ Running linter..."
npm run lint
if [ $? -ne 0 ]; then
  echo "\nâŒ Lint failed!"
  echo "Run: npm run lint:fix"
  exit 1
fi

# Run type checking
echo "\nğŸ“˜ Running type check..."
npm run typecheck
if [ $? -ne 0 ]; then
  echo "\nâŒ Type check failed!"
  exit 1
fi

echo "\nâœ… All pre-commit checks passed!\n"
exit 0
