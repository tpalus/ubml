# ============================================================================
# UBML Actor Fragment Schema
# ============================================================================
# Defines actors and personas - the participants in business processes.
#
# VERSION: 1.0
# ============================================================================

$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "https://ubml.io/schemas/1.0/fragments/actor.fragment.yaml"
title: "UBML Actor Fragment"
description: |
  Actors represent WHO does work in your business processes.
  This fragment defines Actor and Persona types.

$defs:

  # ==========================================================================
  # ACTOR DEFINITION
  # ==========================================================================

  Actor:
    description: |
      Unified participant: people, roles, systems, external parties.
      
      One registry with subtypes for projection mapping:
      - BPMN: organizations/systems → pools, roles/teams → lanes
      - UML use case: roles/external systems → actors
      - RACI: prefer roles, allow teams, people optional
      - ArchiMate: organization/team/person/system → Actor, role → Role
      
      ACTOR TYPES:
      - person: Named individual (for staffing, optional)
      - role: Business role, job function (preferred for RACI)
      - team: Organizational unit, group
      - organization: Legal entity, department
      - system: Application, platform, external API
      - external: Regulator, outsourced provider
      - customer: Customer as a participant
    type: object
    additionalProperties: false
    required: [name, type, kind]
    properties:
      name:
        description: |
          Human-readable name displayed in diagrams and reports.
          
          Examples:
            - "Sales Manager"
            - "Customer Service Team"
            - "SAP ERP"
            - "Building Authority"
        type: string
      
      type:
        description: |
          Classification for views and RACI targeting.
          
          - person: named individual (optional, for staffing)
          - role: business role, job function (preferred for RACI)
          - team: org unit, group
          - organization: legal entity, customer org, supplier
          - system: application/platform/external API
          - external: regulator, outsourced provider
          - customer: customer as a party
        type: string
        enum: [person, role, team, system, organization, external, customer]
      
      kind:
        description: |
          Behavioral category for simulation and views.
          
          - human: people who perform work
          - org: organizational entities
          - system: automated systems
          
          Default derivation if omitted:
          - system → system
          - person/role/team → human
          - organization/external/customer → org
        type: string
        enum: [human, org, system]
      
      isExternal:
        description: |
          Whether this actor is external to the organization.
          
          External actors are outside your organization's direct control:
          - Government agencies, regulators
          - Customers, suppliers, partners
          - Outsourced service providers
          - Third-party systems
          
          Used for:
          - Deadline tracking (external parties may have SLA obligations)
          - Simulation (external steps may have different duration distributions)
          - Views (swimlane separation of internal vs external)
          
          Default derivation if omitted:
          - true for type: external, customer
          - false for type: person, role, team, organization
          - true for type: system when party is external org
        type: boolean
      
      rate:
        description: |
          Cost rate per time unit for simulation costing.
          
          Example:
            rate:
              amount: 75
              currency: "EUR"
              per: h
        $ref: "../common/defs.schema.yaml#/$defs/Rate"
      
      party:
        description: |
          Parent organization (actor ID).
          Used for containment/ownership hierarchy.
          
          Example: A role belongs to a team, which belongs to an organization.
        $ref: "../common/defs.schema.yaml#/$defs/ActorRef"
      
      reportsTo:
        description: |
          Reporting line (actor ID).
          Used for management hierarchy, separate from containment.
        $ref: "../common/defs.schema.yaml#/$defs/ActorRef"
      
      skills:
        description: |
          Skills this actor has, optionally with proficiency levels.
          
          Two forms supported:
          1. Simple reference: "SK001"
          2. With proficiency: { skill: "SK001", level: 3 }
          
          Proficiency levels (1-5) match step.requiresSkills.level:
          1 = Novice, 2 = Basic, 3 = Intermediate, 4 = Advanced, 5 = Expert
        type: array
        items:
          oneOf:
            - $ref: "../common/defs.schema.yaml#/$defs/SkillRef"
            - $ref: "#/$defs/ActorSkill"
      
      description:
        description: "Detailed description of this actor's role and responsibilities."
        type: string
      
      tags:
        description: |
          Tags for filtering and stakeholder-specific views.
          
          Examples: ["customer-facing", "management", "technical"]
        type: array
        items:
          type: string
      
      custom:
        description: "User-defined custom fields."
        $ref: "../common/defs.schema.yaml#/$defs/CustomFields"

  # ==========================================================================
  # ACTOR SKILL (with optional proficiency)
  # ==========================================================================

  ActorSkill:
    description: |
      Skill reference with proficiency level for an actor.
      
      Proficiency levels enable matching against step requirements:
      Actor can perform step if actor.skill.level >= step.requiresSkills.level
      
      Example:
        skill: SK001
        level: 3
    type: object
    additionalProperties: false
    required: [skill]
    properties:
      skill:
        description: "Skill ID reference."
        $ref: "../common/defs.schema.yaml#/$defs/SkillRef"
      level:
        description: |
          Proficiency level (1-5).
          
          1 = Novice: Learning, needs supervision
          2 = Basic: Can perform with guidance
          3 = Intermediate: Independent performer
          4 = Advanced: Can handle complex cases
          5 = Expert: Can teach and innovate
        type: integer
        minimum: 1
        maximum: 5

  # ==========================================================================
  # PAIN POINT DEFINITION
  # ==========================================================================

  PainPoint:
    description: |
      Structured pain point with severity.
      
      Capture specific issues stakeholders experience.
      Severity scale matches Evidence.severity for consistency.
      
      Example:
        text: "Long approval wait times causing project delays"
        severity: 4
        frequency: frequent
    type: object
    additionalProperties: false
    required: [text]
    properties:
      text:
        description: "Description of the pain point."
        type: string
      severity:
        description: |
          Severity level (1-5, 5 being most severe).
          
          1 = Minor inconvenience
          2 = Noticeable issue
          3 = Significant problem
          4 = Major blocker
          5 = Critical showstopper
        type: integer
        minimum: 1
        maximum: 5
      frequency:
        description: "How often this pain point occurs."
        type: string
        enum: [rare, occasional, frequent, constant]

  # ==========================================================================
  # PERSONA DEFINITION
  # ==========================================================================

  Persona:
    description: |
      Stakeholder archetype with goals and pain points.
      
      Personas represent user segments for workshop capture and design thinking.
      They help consultants understand different stakeholder perspectives.
      
      Example:
        id: PS001
        name: "Field Service Manager"
        represents: [AC005, AC006]
        goals:
          - "Optimize technician routes"
          - "Reduce response times"
        painPoints:
          - text: "No visibility into technician location"
            severity: 4
          - "Manual scheduling is time-consuming"
        motivations:
          - "Career advancement"
          - "Team efficiency"
    type: object
    additionalProperties: false
    required: [id, name]
    properties:
      id:
        description: "Unique persona ID (PS### pattern)."
        type: string
        pattern: "^PS\\d{3,}$"
      
      name:
        description: |
          Persona name - a memorable label for this archetype.
          
          Examples:
            - "Busy Executive"
            - "Field Service Manager"
            - "Compliance Officer"
        type: string
      
      represents:
        description: |
          Actor IDs this persona represents.
          Links the archetype to actual organizational roles.
        type: array
        items:
          $ref: "../common/defs.schema.yaml#/$defs/ActorRef"
      
      goals:
        description: |
          What this persona wants to achieve.
          Capture objectives and desired outcomes.
        type: array
        items:
          type: string
      
      painPoints:
        description: |
          Pain points experienced by this persona.
          
          Two forms supported:
          1. Simple text: "Long approval wait times"
          2. Structured: { text: "Long approval wait times", severity: 4 }
        type: array
        items:
          oneOf:
            - type: string
            - $ref: "#/$defs/PainPoint"
      
      motivations:
        description: |
          What drives this persona's behavior.
          Understand underlying motivations for better solutions.
        type: array
        items:
          type: string
      
      tags:
        description: "Tags for filtering and grouping personas."
        type: array
        items:
          type: string
