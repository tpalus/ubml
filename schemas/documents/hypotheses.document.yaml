# ============================================================================
# UBML Hypotheses Document Schema
# ============================================================================
# Schema for .hypotheses.ubml.yaml files - hypothesis tree definitions.
#
# FILE PATTERN: *.hypotheses.ubml.yaml
# ============================================================================

$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "https://ubml.io/schemas/1.2/documents/hypotheses.document.yaml"
title: "Hypotheses"
description: |
  Hypothesis documents define hypothesis trees for structured problem framing.
  
  WHAT IS A HYPOTHESIS TREE?
  A hypothesis tree decomposes a main hypothesis into sub-hypotheses
  that can be independently validated. It uses the SCQH framework:
  - Situation: Current state/context
  - Complication: What changed/problem
  - Question: Key question arising
  - Hypothesis: Proposed answer
  
  WHY USE HYPOTHESIS TREES?
  Hypothesis trees enable:
  - Structured problem decomposition
  - Evidence-based decision making
  - Clear communication of reasoning
  - Progress tracking on analysis
  
  FILE NAMING: *.hypotheses.ubml.yaml
  Examples:
    - process-improvement.hypotheses.ubml.yaml
    - market-entry.hypotheses.ubml.yaml
    - cost-reduction.hypotheses.ubml.yaml

# CLI metadata - structured data for tooling
x-ubml-cli:
  category: analysis
  categoryDisplayName: "Analysis & Planning"
  workflowOrder: 6
  shortDescription: "Define hypothesis trees for structured problem framing."
  defaultFilename: "solution"
  detectBy:
    - hypothesisTrees
  gettingStarted:
    - "Define the SCQH context"
    - "Create the root hypothesis"
    - "Decompose into sub-hypotheses"
    - "Track validation status as you gather evidence"
  exampleFilename: "solution.hypotheses.ubml.yaml"

type: object
additionalProperties: false
required: [ubml]

properties:
  ubml:
    description: |
      UBML version identifier.
      Must be "1.2" for this schema version.
    type: string
    const: "1.2"
  
  name:
    description: |
      Optional document name.
      If not provided, the filename is used.
    type: string
  
  description:
    description: |
      Document description.
      Explain what analysis is contained in this file.
    type: string
  
  hypothesisTrees:
    description: |
      Hypothesis tree definitions, keyed by tree ID.
      
      Hypothesis tree IDs follow the HT### pattern (e.g., HT00001, HT00002).
      
      Example:
        hypothesisTrees:
          HT00001:
            name: "Process Optimization Analysis"
            scqh:
              situation: "Current process takes 5 days"
              complication: "Customers expect 2 days"
              question: "How can we reduce to 2 days?"
              hypothesis: "Streamline approvals and automate"
            root:
              id: H001
              text: "We can achieve 2-day processing"
              children:
                - id: H002
                  text: "Approvals can be streamlined"
    type: object
    additionalProperties: false
    patternProperties:
      "^HT\\d{5,}$":
        $ref: "../fragments/hypothesis.fragment.yaml#/$defs/HypothesisTree"
  
  metadata:
    description: "Document metadata."
    type: object
    additionalProperties: false
    properties:
      createdAt:
        type: string
        format: date-time
      createdBy:
        type: string
      updatedAt:
        type: string
        format: date-time
      updatedBy:
        type: string
  
  tags:
    description: "Tags for filtering and organization."
    type: array
    items:
      type: string
  
  custom:
    description: "User-defined custom fields."
    $ref: "../common/defs.schema.yaml#/$defs/CustomFields"
